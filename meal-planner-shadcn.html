<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meal Planner - Modern UI</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        border: "hsl(214.3 31.8% 91.4%)",
                        input: "hsl(214.3 31.8% 91.4%)",
                        ring: "hsl(222.2 84% 61.8%)",
                        background: "hsl(0 0% 100%)",
                        foreground: "hsl(222.2 84% 4.9%)",
                        primary: {
                            DEFAULT: "hsl(222.2 47.4% 52.2%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        secondary: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)",
                        },
                        destructive: {
                            DEFAULT: "hsl(0 84.2% 60.2%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        muted: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(215.4 16.3% 46.9%)",
                        },
                        accent: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)",
                        },
                        card: {
                            DEFAULT: "hsl(0 0% 100%)",
                            foreground: "hsl(222.2 84% 4.9%)",
                        },
                    },
                    borderRadius: {
                        lg: "0.5rem",
                        md: "0.375rem",
                        sm: "0.25rem",
                    },
                    fontFamily: {
                        sans: ["Inter", "system-ui", "sans-serif"],
                    },
                },
            },
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Drag ghost image */
        .dragging {
            opacity: 0.5;
        }

        /* Drop indicator */
        .drop-indicator {
            background: #3b82f6;
            height: 2px;
            margin: 8px 0;
            border-radius: 1px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .drop-indicator.active {
            opacity: 1;
        }

        /* Smooth animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: slideIn 0.3s ease;
        }

        /* Category colors */
        .category-protein {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        }

        .category-veg {
            background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        }

        .category-fruit {
            background: linear-gradient(135deg, #f472b6 0%, #ec4899 100%);
        }

        .category-carbs {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
        }

        .category-extras {
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Food data
        const foodDatabase = {
            protein: [
                { id: 'p1', name: 'Chicken Breast', quantity: 100, unit: 'g', kcal: 165, protein: 31, carbs: 0, fat: 3.6, cost: 3.50 },
                { id: 'p2', name: 'Salmon', quantity: 100, unit: 'g', kcal: 206, protein: 22, carbs: 0, fat: 13, cost: 5.75 },
                { id: 'p3', name: 'Eggs', quantity: 2, unit: 'large', kcal: 156, protein: 13, carbs: 1.2, fat: 11, cost: 1.20 },
                { id: 'p4', name: 'Tofu', quantity: 150, unit: 'g', kcal: 144, protein: 15, carbs: 3.5, fat: 8.7, cost: 2.25 },
            ],
            veg: [
                { id: 'v1', name: 'Broccoli', quantity: 1, unit: 'cup', kcal: 31, protein: 3, carbs: 6, fat: 0, cost: 1.25 },
                { id: 'v2', name: 'Spinach', quantity: 2, unit: 'cups', kcal: 14, protein: 2, carbs: 2, fat: 0, cost: 1.00 },
                { id: 'v3', name: 'Bell Pepper', quantity: 1, unit: 'medium', kcal: 24, protein: 1, carbs: 6, fat: 0, cost: 1.50 },
                { id: 'v4', name: 'Mushrooms', quantity: 0.5, unit: 'cup', kcal: 15, protein: 2, carbs: 2, fat: 0.3, cost: 0.75 },
            ],
            fruit: [
                { id: 'f1', name: 'Apple', quantity: 1, unit: 'medium', kcal: 95, protein: 0.5, carbs: 25, fat: 0.3, cost: 0.50 },
                { id: 'f2', name: 'Banana', quantity: 1, unit: 'medium', kcal: 105, protein: 1.3, carbs: 27, fat: 0.4, cost: 0.35 },
                { id: 'f3', name: 'Berries', quantity: 1, unit: 'cup', kcal: 84, protein: 1, carbs: 21, fat: 0.5, cost: 2.00 },
            ],
            carbs: [
                { id: 'c1', name: 'Brown Rice', quantity: 1, unit: 'cup', kcal: 216, protein: 5, carbs: 45, fat: 2, cost: 1.00 },
                { id: 'c2', name: 'Quinoa', quantity: 1, unit: 'cup', kcal: 222, protein: 8, carbs: 39, fat: 4, cost: 2.00 },
                { id: 'c3', name: 'Sweet Potato', quantity: 1, unit: 'medium', kcal: 103, protein: 2, carbs: 24, fat: 0, cost: 0.75 },
            ],
            extras: [
                { id: 'e1', name: 'Olive Oil', quantity: 1, unit: 'tbsp', kcal: 119, protein: 0, carbs: 0, fat: 14, cost: 0.25 },
                { id: 'e2', name: 'Almonds', quantity: 1, unit: 'oz', kcal: 164, protein: 6, carbs: 6, fat: 14, cost: 1.50 },
                { id: 'e3', name: 'Avocado', quantity: 0.5, unit: 'medium', kcal: 120, protein: 1.5, carbs: 6, fat: 11, cost: 1.00 },
            ],
        };

        function MealPlanner() {
            const [categories, setCategories] = useState([]);
            const [days, setDays] = useState([
                { 
                    id: 'monday', 
                    name: 'Monday', 
                    meals: [
                        { id: 'm1', name: 'Breakfast', time: '07:00', items: [] },
                        { id: 'm2', name: 'Lunch', time: '12:00', items: [] },
                        { id: 'm3', name: 'Dinner', time: '18:00', items: [] },
                    ] 
                },
                { 
                    id: 'tuesday', 
                    name: 'Tuesday', 
                    meals: [
                        { id: 'm4', name: 'Breakfast', time: '07:00', items: [] },
                        { id: 'm5', name: 'Lunch', time: '12:00', items: [] },
                        { id: 'm6', name: 'Dinner', time: '18:00', items: [] },
                    ] 
                },
            ]);

            const [draggedItem, setDraggedItem] = useState(null);
            const [dragOverInfo, setDragOverInfo] = useState(null);

            const handleDragStart = (e, item, source) => {
                setDraggedItem({ ...item, source });
                e.dataTransfer.effectAllowed = 'copy';
            };

            const handleDragEnd = () => {
                setDraggedItem(null);
                setDragOverInfo(null);
            };

            const handleDragOver = (e, dayId, mealId) => {
                e.preventDefault();
                setDragOverInfo({ dayId, mealId });
            };

            const handleDrop = (e, dayId, mealId) => {
                e.preventDefault();
                if (!draggedItem) return;

                const newItem = {
                    ...draggedItem,
                    id: `${draggedItem.id}-${Date.now()}`,
                };

                setDays(prevDays => 
                    prevDays.map(day => 
                        day.id === dayId 
                            ? {
                                ...day,
                                meals: day.meals.map(meal =>
                                    meal.id === mealId
                                        ? { ...meal, items: [...meal.items, newItem] }
                                        : meal
                                )
                            }
                            : day
                    )
                );

                setDragOverInfo(null);
            };

            const addCategory = (categoryName) => {
                if (!categories.includes(categoryName)) {
                    setCategories([...categories, categoryName]);
                }
            };

            const removeCategory = (categoryName) => {
                setCategories(categories.filter(c => c !== categoryName));
            };

            const removeFoodItem = (dayId, mealId, itemId) => {
                setDays(prevDays =>
                    prevDays.map(day =>
                        day.id === dayId
                            ? {
                                ...day,
                                meals: day.meals.map(meal =>
                                    meal.id === mealId
                                        ? { ...meal, items: meal.items.filter(item => item.id !== itemId) }
                                        : meal
                                )
                            }
                            : day
                    )
                );
            };

            const calculateMealTotals = (items) => {
                return items.reduce((acc, item) => ({
                    kcal: acc.kcal + item.kcal,
                    protein: acc.protein + item.protein,
                    carbs: acc.carbs + item.carbs,
                    fat: acc.fat + item.fat,
                    cost: acc.cost + item.cost,
                }), { kcal: 0, protein: 0, carbs: 0, fat: 0, cost: 0 });
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50">
                    {/* Header */}
                    <header className="bg-white border-b border-gray-200 shadow-sm">
                        <div className="px-6 py-4">
                            <h1 className="text-2xl font-bold text-gray-900">🍱 Weekly Meal Planner</h1>
                        </div>
                    </header>

                    {/* Category Pills */}
                    <div className="bg-white border-b border-gray-200 px-6 py-4">
                        <div className="flex items-center gap-3">
                            <span className="text-sm font-medium text-gray-600">Drag categories →</span>
                            {Object.keys(foodDatabase).map(category => (
                                <div
                                    key={category}
                                    draggable
                                    onDragStart={(e) => handleDragStart(e, { type: 'category', name: category }, 'pills')}
                                    onDragEnd={handleDragEnd}
                                    className={`px-4 py-2 rounded-full cursor-move text-white font-medium text-sm shadow-md hover:shadow-lg transition-shadow category-${category}`}
                                >
                                    {category.charAt(0).toUpperCase() + category.slice(1)}
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Main Board */}
                    <div className="flex gap-4 p-6 overflow-x-auto">
                        {/* Category Columns */}
                        {categories.map(category => (
                            <div key={category} className="bg-white rounded-lg shadow-md min-w-[280px] animate-in">
                                <div className={`px-4 py-3 rounded-t-lg text-white font-semibold category-${category}`}>
                                    <div className="flex justify-between items-center">
                                        <span>{category.charAt(0).toUpperCase() + category.slice(1)}</span>
                                        <button
                                            onClick={() => removeCategory(category)}
                                            className="text-white/80 hover:text-white"
                                        >
                                            ✕
                                        </button>
                                    </div>
                                </div>
                                <div className="p-3 space-y-2 max-h-[600px] overflow-y-auto">
                                    {foodDatabase[category]?.map(food => (
                                        <div
                                            key={food.id}
                                            draggable
                                            onDragStart={(e) => handleDragStart(e, food, 'category')}
                                            onDragEnd={handleDragEnd}
                                            className="bg-gray-50 p-3 rounded-lg cursor-move hover:bg-gray-100 transition-colors"
                                        >
                                            <div className="font-medium text-sm text-gray-900">{food.name}</div>
                                            <div className="text-xs text-gray-600 mt-1">
                                                {food.quantity} {food.unit}
                                            </div>
                                            <div className="flex gap-2 mt-2 flex-wrap">
                                                <span className="text-xs bg-white px-2 py-1 rounded">{food.kcal} kcal</span>
                                                <span className="text-xs bg-white px-2 py-1 rounded">{food.protein}g P</span>
                                                <span className="text-xs bg-white px-2 py-1 rounded">${food.cost}</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))}

                        {/* Day Columns */}
                        {days.map(day => (
                            <div key={day.id} className="bg-white rounded-lg shadow-md min-w-[320px]">
                                <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 rounded-t-lg">
                                    <div className="font-bold text-lg">{day.name}</div>
                                </div>
                                
                                <div className="p-4 space-y-3">
                                    {day.meals.map(meal => (
                                        <div key={meal.id} className="border border-gray-200 rounded-lg overflow-hidden">
                                            <div className="bg-gray-50 px-3 py-2 border-b border-gray-200">
                                                <div className="flex justify-between items-center">
                                                    <span className="font-medium text-sm">{meal.name}</span>
                                                    <span className="text-xs text-gray-500">{meal.time}</span>
                                                </div>
                                            </div>
                                            
                                            <div
                                                className={`min-h-[80px] p-3 ${
                                                    dragOverInfo?.dayId === day.id && dragOverInfo?.mealId === meal.id
                                                        ? 'bg-blue-50 border-2 border-blue-300 border-dashed'
                                                        : 'bg-white'
                                                }`}
                                                onDragOver={(e) => handleDragOver(e, day.id, meal.id)}
                                                onDragLeave={() => setDragOverInfo(null)}
                                                onDrop={(e) => handleDrop(e, day.id, meal.id)}
                                            >
                                                {meal.items.length === 0 ? (
                                                    <div className="text-gray-400 text-sm text-center">
                                                        Drag food items here
                                                    </div>
                                                ) : (
                                                    <div className="space-y-2">
                                                        {meal.items.map(item => (
                                                            <div key={item.id} className="bg-gray-50 p-2 rounded flex justify-between items-start">
                                                                <div className="flex-1">
                                                                    <div className="text-sm font-medium">{item.name}</div>
                                                                    <div className="text-xs text-gray-600">
                                                                        {item.quantity} {item.unit} • {item.kcal} kcal
                                                                    </div>
                                                                </div>
                                                                <button
                                                                    onClick={() => removeFoodItem(day.id, meal.id, item.id)}
                                                                    className="text-gray-400 hover:text-red-500 ml-2"
                                                                >
                                                                    ✕
                                                                </button>
                                                            </div>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                            
                                            {meal.items.length > 0 && (
                                                <div className="bg-gray-50 px-3 py-2 border-t border-gray-200">
                                                    <div className="flex gap-3 text-xs">
                                                        <span className="font-medium">
                                                            {calculateMealTotals(meal.items).kcal} kcal
                                                        </span>
                                                        <span className="text-gray-600">
                                                            {calculateMealTotals(meal.items).protein.toFixed(1)}g P
                                                        </span>
                                                        <span className="text-gray-600">
                                                            ${calculateMealTotals(meal.items).cost.toFixed(2)}
                                                        </span>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                                
                                {/* Day Totals */}
                                <div className="bg-gray-50 px-4 py-3 border-t border-gray-200">
                                    <div className="text-sm font-medium text-gray-700 mb-2">Day Totals</div>
                                    <div className="grid grid-cols-2 gap-2 text-xs">
                                        <div>Calories: <span className="font-semibold">
                                            {day.meals.reduce((acc, meal) => 
                                                acc + calculateMealTotals(meal.items).kcal, 0
                                            )}
                                        </span></div>
                                        <div>Protein: <span className="font-semibold">
                                            {day.meals.reduce((acc, meal) => 
                                                acc + calculateMealTotals(meal.items).protein, 0
                                            ).toFixed(1)}g
                                        </span></div>
                                        <div>Cost: <span className="font-semibold">
                                            ${day.meals.reduce((acc, meal) => 
                                                acc + calculateMealTotals(meal.items).cost, 0
                                            ).toFixed(2)}
                                        </span></div>
                                    </div>
                                </div>
                            </div>
                        ))}

                        {/* Drop zone for categories */}
                        <div
                            className={`min-w-[200px] border-2 border-dashed rounded-lg flex items-center justify-center ${
                                draggedItem?.type === 'category' ? 'border-blue-400 bg-blue-50' : 'border-gray-300'
                            }`}
                            onDragOver={(e) => e.preventDefault()}
                            onDrop={(e) => {
                                e.preventDefault();
                                if (draggedItem?.type === 'category') {
                                    addCategory(draggedItem.name);
                                }
                                handleDragEnd();
                            }}
                        >
                            <div className="text-gray-400 text-sm text-center p-4">
                                Drop categories here
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MealPlanner />, document.getElementById('root'));
    </script>
</body>
</html>